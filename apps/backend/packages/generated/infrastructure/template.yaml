AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: Generated by Scaffold AI
Resources:
  s3bucketBucket:
    Type: AWS::S3::Bucket
    Properties:
      BucketEncryption:
        ServerSideEncryptionConfiguration:
        - ServerSideEncryptionByDefault:
            SSEAlgorithm: AES256
      VersioningConfiguration:
        Status: Enabled
      PublicAccessBlockConfiguration:
        BlockPublicAcls: true
        BlockPublicPolicy: true
        IgnorePublicAcls: true
        RestrictPublicBuckets: true
  helloworldlambdaFunction:
    Type: AWS::Serverless::Function
    Properties:
      Runtime: nodejs20.x
      Handler: index.handler
      CodeUri: ./src
      Description: Hello World Lambda
      Tracing: Active
  apigatewayApi:
    Type: AWS::Serverless::Api
    Properties:
      StageName: prod
      Description: API Gateway
      TracingEnabled: true
      MethodSettings:
      - ResourcePath: /*
        HttpMethod: '*'
        LoggingLevel: INFO
        MetricsEnabled: true
  dynamodbTable:
    Type: AWS::DynamoDB::Table
    Properties:
      BillingMode: PAY_PER_REQUEST
      AttributeDefinitions:
      - AttributeName: pk
        AttributeType: S
      - AttributeName: sk
        AttributeType: S
      KeySchema:
      - AttributeName: pk
        KeyType: HASH
      - AttributeName: sk
        KeyType: RANGE
      PointInTimeRecoverySpecification:
        PointInTimeRecoveryEnabled: true
      SSESpecification:
        SSEEnabled: true
  cognitoUserPool:
    Type: AWS::Cognito::UserPool
    Properties:
      UserPoolName: Cognito
      MfaConfiguration: OPTIONAL
      Policies:
        PasswordPolicy:
          MinimumLength: 12
          RequireLowercase: true
          RequireUppercase: true
          RequireNumbers: true
          RequireSymbols: true
  cognitoUserPoolClient:
    Type: AWS::Cognito::UserPoolClient
    Properties:
      UserPoolId:
        Ref: cognitoUserPool
      ClientName: CognitoWebClient
      ExplicitAuthFlows:
      - ALLOW_USER_SRP_AUTH
      - ALLOW_REFRESH_TOKEN_AUTH
  sqsDLQ:
    Type: AWS::SQS::Queue
    Properties:
      QueueName: SQS-dlq
      MessageRetentionPeriod: 1209600
      SqsManagedSseEnabled: true
  sqsQueue:
    Type: AWS::SQS::Queue
    Properties:
      QueueName: SQS
      SqsManagedSseEnabled: true
      RedrivePolicy:
        deadLetterTargetArn:
          Fn::GetAtt:
          - sqsDLQ
          - Arn
        maxReceiveCount: 3
  eventbridgeEventBus:
    Type: AWS::Events::EventBus
    Properties:
      Name: eventbridge-bus
  stepfunctionsStateMachine:
    Type: AWS::StepFunctions::StateMachine
    Properties:
      StateMachineType: EXPRESS
      TracingConfiguration:
        Enabled: true
      Definition:
        Comment: Step Functions
        StartAt: Start
        States:
          Start:
            Type: Pass
            End: true
  kinesisStream:
    Type: AWS::Kinesis::Stream
    Properties:
      ShardCount: 1
      StreamEncryption:
        EncryptionType: KMS
        KeyId: alias/aws/kinesis
  snsTopic:
    Type: AWS::SNS::Topic
    Properties:
      DisplayName: SNS
Outputs:
  s3bucketBucketArn:
    Value:
      Fn::GetAtt:
      - s3bucketBucket
      - Arn
    Description: ARN of s3bucketBucket
  helloworldlambdaFunctionArn:
    Value:
      Fn::GetAtt:
      - helloworldlambdaFunction
      - Arn
    Description: ARN of helloworldlambdaFunction
  dynamodbTableArn:
    Value:
      Fn::GetAtt:
      - dynamodbTable
      - Arn
    Description: ARN of dynamodbTable
  cognitoUserPoolArn:
    Value:
      Fn::GetAtt:
      - cognitoUserPool
      - Arn
    Description: ARN of cognitoUserPool
  sqsDLQArn:
    Value:
      Fn::GetAtt:
      - sqsDLQ
      - Arn
    Description: ARN of sqsDLQ
  sqsQueueArn:
    Value:
      Fn::GetAtt:
      - sqsQueue
      - Arn
    Description: ARN of sqsQueue
  stepfunctionsStateMachineArn:
    Value:
      Fn::GetAtt:
      - stepfunctionsStateMachine
      - Arn
    Description: ARN of stepfunctionsStateMachine
  kinesisStreamArn:
    Value:
      Fn::GetAtt:
      - kinesisStream
      - Arn
    Description: ARN of kinesisStream
  snsTopicArn:
    Value:
      Fn::GetAtt:
      - snsTopic
      - Arn
    Description: ARN of snsTopic
